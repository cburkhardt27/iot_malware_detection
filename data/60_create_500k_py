import numpy as np
import pdb
# create two arrays of random unique indices for row numbers
# splitting the data based on row label in order to read in file line by line (file too big for Shuffle())

def main():
    num=500000
    start = 8
    end = 3581028

    arr = np.random.choice(np.arange(start,end+1),size = num,replace=False)
    set_train_ind = set(arr)
 
    lnr = 0
    train_f = open('60_train_data_500k.csv','w')

    with open('conn.log.labeled','r') as f:
        for line in f:
            if lnr < 6:
                pass
            elif lnr == 6 or lnr == 7:
                train_f.write(line)
            else:
              #  pdb.set_trace()
                if lnr in set_train_ind:
                #    pdb.set_trace()
                    train_f.write(line)
            if (lnr % 100000 ==0):
                print("Row number: ", lnr)  
              #  pdb.set_trace()
            lnr += 1
    f.close()


if __name__ == "__main__":
    main()