import numpy as np

# create two arrays of random unique indices for row numbers
# splitting the data based on row label in order to read in file line by line (file too big for Shuffle())
def createRandomArr(num,start,end):
    arr = np.random.choice(np.arange(start,end+1),size = num,replace=False)
    return set(arr)

def main():
    set_other_mal_ind = createRandomArr(500000,3,29191517)
    set_hor_port_ind = createRandomArr(500000,3,58052516)
    lnr = 0

    mal_ben_bulk_f = open('other_mal_500k.csv','w')
    hor_port_ben_bulk_f = open('hor_port_500k.csv','w')

    with open('hor_port_ben_bulk.csv','r') as f:
        for line in f:
            if lnr in set_hor_port_ind:
                hor_port_ben_bulk_f.write(line)
            if (lnr % 100000 == 1):
                print("Row: ", lnr)
            lnr += 1
    lnr1 = 0
    with open('mal_ben_bulk.csv','r') as f:
        for line in f:
            if lnr1 in set_other_mal_ind:
                mal_ben_bulk_f.write(line)
            if (lnr1 % 100000 == 1):
                print("Row: ", lnr1)
            lnr1 += 1

    print("Hor port row number: ", lnr)
    print("Other malware row number: ", lnr1)


if __name__ == "__main__":
    main()